const translations = {
  en: {
    languageQuestionFirst: 'Hey, what language can we speak?',
    welcomeTitle: 'Welcome to CustomLibrary',
    helloQuestion: 'Hey, what\'s your name?',
    yourName: 'Your name',
    continue: 'Continue',
    loginTitle: 'Login',
    registerTitle: 'Register',
    username: 'Username',
    password: 'Password',
    loginBtn: 'Login',
    registerBtn: 'Register',
    noAccount: 'Don\'t have an account?',
    hasAccount: 'Already have an account?',
    registerLink: 'Register',
    loginLink: 'Login',
    myLibrary: 'My Library',
    friends: 'Friends',
    ratings: 'Ratings',
    logout: 'Logout',
    myLists: 'My Lists',
    createList: 'Create List',
    addItems: 'Add Items',
    searchPlaceholder: 'Search movies/series',
    madeWith: 'Made with',
    createListModalTitle: 'Create New List',
    listName: 'List name',
    customMessage: 'Custom message (optional)',
    create: 'Create',
    cancel: 'Cancel',
    selectListModalTitle: 'Select List',
    shareListModalTitle: 'Share List',
    pinLabel: 'PIN:',
    copyPin: 'Copy PIN',
    close: 'Close',
    importModalTitle: 'Import List',
    enterPin: 'Enter PIN',
    import: 'Import',
    friendsModalTitle: 'Friends',
    myFriendsTab: 'My Friends',
    addFriendTab: 'Add Friend',
    addFriend: 'Add Friend',
    ratingsModalTitle: 'Item Ratings',
    allUsers: 'All Users',
    friendsOnly: 'Friends Only',
    rateModalTitle: 'Rate Item',
    confirm: 'Confirm',
    share: 'Share',
    delete: 'Delete',
    director: 'Director',
    cast: 'Cast',
    recentReviews: 'Recent Reviews',
    trailer: 'Trailer',
    addToList: 'Add to List',
    friendRatings: 'Ratings',
    friendLists: 'Lists',
    importList: 'Import'
  },
  es: {
    languageQuestionFirst: 'Hola, Â¿quÃ© idioma hablamos?',
    welcomeTitle: 'Bienvenido a CustomLibrary',
    helloQuestion: 'Hola, Â¿cÃ³mo te llamas?',
    yourName: 'Tu nombre',
    continue: 'Continuar',
    loginTitle: 'Iniciar sesiÃ³n',
    registerTitle: 'Registrarse',
    username: 'Usuario',
    password: 'ContraseÃ±a',
    loginBtn: 'Entrar',
    registerBtn: 'Registrarse',
    noAccount: 'Â¿No tienes cuenta?',
    hasAccount: 'Â¿Ya tienes cuenta?',
    registerLink: 'RegÃ­strate',
    loginLink: 'Inicia sesiÃ³n',
    myLibrary: 'Mi LibrerÃ­a',
    friends: 'Amigos',
    ratings: 'Valoraciones',
    logout: 'Salir',
    myLists: 'Mis Listas',
    createList: 'Crear Lista',
    addItems: 'AÃ±adir Ãtems',
    searchPlaceholder: 'Buscar pelÃ­culas/series',
    madeWith: 'Hecho con',
    createListModalTitle: 'Crear Nueva Lista',
    listName: 'Nombre de la lista',
    customMessage: 'Mensaje personalizado (opcional)',
    create: 'Crear',
    cancel: 'Cancelar',
    selectListModalTitle: 'Seleccionar Lista',
    shareListModalTitle: 'Compartir Lista',
    pinLabel: 'PIN:',
    copyPin: 'Copiar PIN',
    close: 'Cerrar',
    importModalTitle: 'Importar Lista',
    enterPin: 'Introduce el PIN',
    import: 'Importar',
    friendsModalTitle: 'Amigos',
    myFriendsTab: 'Mis Amigos',
    addFriendTab: 'AÃ±adir Amigo',
    addFriend: 'AÃ±adir Amigo',
    ratingsModalTitle: 'Valoraciones del Ãtem',
    allUsers: 'Todos los Usuarios',
    friendsOnly: 'Solo Amigos',
    rateModalTitle: 'Valorar Ãtem',
    confirm: 'Confirmar',
    share: 'Compartir',
    delete: 'Eliminar',
    director: 'Director',
    cast: 'Reparto',
    recentReviews: 'ReseÃ±as Recientes',
    trailer: 'TrÃ¡iler',
    addToList: 'AÃ±adir a Lista',
    friendRatings: 'Valoraciones',
    friendLists: 'Listas',
    importList: 'Importar'
  },
  fr: {
    languageQuestionFirst: 'Salut, quelle langue parlons-nous?',
    welcomeTitle: 'Bienvenue Ã  CustomLibrary',
    helloQuestion: 'Salut, comment tu t\'appelles?',
    yourName: 'Ton nom',
    continue: 'Continuer',
    loginTitle: 'Connexion',
    registerTitle: 'S\'inscrire',
    username: 'Nom d\'utilisateur',
    password: 'Mot de passe',
    loginBtn: 'Se connecter',
    registerBtn: 'S\'inscrire',
    noAccount: 'Pas de compte?',
    hasAccount: 'DÃ©jÃ  un compte?',
    registerLink: 'Inscris-toi',
    loginLink: 'Connecte-toi',
    myLibrary: 'Ma BibliothÃ¨que',
    friends: 'Amis',
    ratings: 'Notes',
    logout: 'DÃ©connexion',
    myLists: 'Mes Listes',
    createList: 'CrÃ©er Liste',
    addItems: 'Ajouter Items',
    searchPlaceholder: 'Rechercher films/sÃ©ries',
    madeWith: 'Fait avec',
    createListModalTitle: 'CrÃ©er Nouvelle Liste',
    listName: 'Nom de la liste',
    customMessage: 'Message personnalisÃ© (optionnel)',
    create: 'CrÃ©er',
    cancel: 'Annuler',
    selectListModalTitle: 'SÃ©lectionner Liste',
    shareListModalTitle: 'Partager Liste',
    pinLabel: 'PIN:',
    copyPin: 'Copier PIN',
    close: 'Fermer',
    importModalTitle: 'Importer Liste',
    enterPin: 'Entrer le PIN',
    import: 'Importer',
    friendsModalTitle: 'Amis',
    myFriendsTab: 'Mes Amis',
    addFriendTab: 'Ajouter Ami',
    addFriend: 'Ajouter Ami',
    ratingsModalTitle: 'Notes de l\'Item',
    allUsers: 'Tous les Utilisateurs',
    friendsOnly: 'Amis Seulement',
    rateModalTitle: 'Noter Item',
    confirm: 'Confirmer',
    share: 'Partager',
    delete: 'Supprimer',
    director: 'RÃ©alisateur',
    cast: 'Distribution',
    recentReviews: 'Avis RÃ©cents',
    trailer: 'Bande-annonce',
    addToList: 'Ajouter Ã  la Liste',
    friendRatings: 'Notes',
    friendLists: 'Listes',
    importList: 'Importer'
  },
  de: {
    languageQuestionFirst: 'Hey, welche Sprache sprechen wir?',
    welcomeTitle: 'Willkommen bei CustomLibrary',
    helloQuestion: 'Hey, wie heiÃŸt du?',
    yourName: 'Dein Name',
    continue: 'Weiter',
    loginTitle: 'Anmelden',
    registerTitle: 'Registrieren',
    username: 'Benutzername',
    password: 'Passwort',
    loginBtn: 'Anmelden',
    registerBtn: 'Registrieren',
    noAccount: 'Kein Konto?',
    hasAccount: 'Bereits ein Konto?',
    registerLink: 'Registrieren',
    loginLink: 'Anmelden',
    myLibrary: 'Meine Bibliothek',
    friends: 'Freunde',
    ratings: 'Bewertungen',
    logout: 'Abmelden',
    myLists: 'Meine Listen',
    createList: 'Liste Erstellen',
    addItems: 'Items HinzufÃ¼gen',
    searchPlaceholder: 'Filme/Serien suchen',
    madeWith: 'Gemacht mit',
    createListModalTitle: 'Neue Liste Erstellen',
    listName: 'Listenname',
    customMessage: 'Benutzerdefinierte Nachricht (optional)',
    create: 'Erstellen',
    cancel: 'Abbrechen',
    selectListModalTitle: 'Liste AuswÃ¤hlen',
    shareListModalTitle: 'Liste Teilen',
    pinLabel: 'PIN:',
    copyPin: 'PIN Kopieren',
    close: 'SchlieÃŸen',
    importModalTitle: 'Liste Importieren',
    enterPin: 'PIN Eingeben',
    import: 'Importieren',
    friendsModalTitle: 'Freunde',
    myFriendsTab: 'Meine Freunde',
    addFriendTab: 'Freund HinzufÃ¼gen',
    addFriend: 'Freund HinzufÃ¼gen',
    ratingsModalTitle: 'Item Bewertungen',
    allUsers: 'Alle Benutzer',
    friendsOnly: 'Nur Freunde',
    rateModalTitle: 'Item Bewerten',
    confirm: 'BestÃ¤tigen',
    share: 'Teilen',
    delete: 'LÃ¶schen',
    director: 'Regisseur',
    cast: 'Besetzung',
    recentReviews: 'Aktuelle Rezensionen',
    trailer: 'Trailer',
    addToList: 'Zur Liste HinzufÃ¼gen',
    friendRatings: 'Bewertungen',
    friendLists: 'Listen',
    importList: 'Importieren'
  },
  it: {
    languageQuestionFirst: 'Ciao, che lingua parliamo?',
    welcomeTitle: 'Benvenuto a CustomLibrary',
    helloQuestion: 'Ciao, come ti chiami?',
    yourName: 'Il tuo nome',
    continue: 'Continua',
    loginTitle: 'Accedi',
    registerTitle: 'Registrati',
    username: 'Nome utente',
    password: 'Password',
    loginBtn: 'Accedi',
    registerBtn: 'Registrati',
    noAccount: 'Non hai un account?',
    hasAccount: 'Hai giÃ  un account?',
    registerLink: 'Registrati',
    loginLink: 'Accedi',
    myLibrary: 'La Mia Libreria',
    friends: 'Amici',
    ratings: 'Valutazioni',
    logout: 'Esci',
    myLists: 'Le Mie Liste',
    createList: 'Crea Lista',
    addItems: 'Aggiungi Items',
    searchPlaceholder: 'Cerca film/serie',
    madeWith: 'Fatto con',
    createListModalTitle: 'Crea Nuova Lista',
    listName: 'Nome della lista',
    customMessage: 'Messaggio personalizzato (opzionale)',
    create: 'Crea',
    cancel: 'Annulla',
    selectListModalTitle: 'Seleziona Lista',
    shareListModalTitle: 'Condividi Lista',
    pinLabel: 'PIN:',
    copyPin: 'Copia PIN',
    close: 'Chiudi',
    importModalTitle: 'Importa Lista',
    enterPin: 'Inserisci PIN',
    import: 'Importa',
    friendsModalTitle: 'Amici',
    myFriendsTab: 'I Miei Amici',
    addFriendTab: 'Aggiungi Amico',
    addFriend: 'Aggiungi Amico',
    ratingsModalTitle: 'Valutazioni Item',
    allUsers: 'Tutti gli Utenti',
    friendsOnly: 'Solo Amici',
    rateModalTitle: 'Valuta Item',
    confirm: 'Conferma',
    share: 'Condividi',
    delete: 'Elimina',
    director: 'Regista',
    cast: 'Cast',
    recentReviews: 'Recensioni Recenti',
    trailer: 'Trailer',
    addToList: 'Aggiungi alla Lista',
    friendRatings: 'Valutazioni',
    friendLists: 'Liste',
    importList: 'Importa'
  },
  pt: {
    languageQuestionFirst: 'OlÃ¡, que idioma falamos?',
    welcomeTitle: 'Bem-vindo ao CustomLibrary',
    helloQuestion: 'OlÃ¡, qual Ã© o teu nome?',
    yourName: 'O teu nome',
    continue: 'Continuar',
    loginTitle: 'Entrar',
    registerTitle: 'Registar',
    username: 'Nome de utilizador',
    password: 'Palavra-passe',
    loginBtn: 'Entrar',
    registerBtn: 'Registar',
    noAccount: 'NÃ£o tens conta?',
    hasAccount: 'JÃ¡ tens conta?',
    registerLink: 'Regista-te',
    loginLink: 'Entra',
    myLibrary: 'A Minha Biblioteca',
    friends: 'Amigos',
    ratings: 'AvaliaÃ§Ãµes',
    logout: 'Sair',
    myLists: 'As Minhas Listas',
    createList: 'Criar Lista',
    addItems: 'Adicionar Items',
    searchPlaceholder: 'Procurar filmes/sÃ©ries',
    madeWith: 'Feito com',
    createListModalTitle: 'Criar Nova Lista',
    listName: 'Nome da lista',
    customMessage: 'Mensagem personalizada (opcional)',
    create: 'Criar',
    cancel: 'Cancelar',
    selectListModalTitle: 'Selecionar Lista',
    shareListModalTitle: 'Partilhar Lista',
    pinLabel: 'PIN:',
    copyPin: 'Copiar PIN',
    close: 'Fechar',
    importModalTitle: 'Importar Lista',
    enterPin: 'Inserir PIN',
    import: 'Importar',
    friendsModalTitle: 'Amigos',
    myFriendsTab: 'Os Meus Amigos',
    addFriendTab: 'Adicionar Amigo',
    addFriend: 'Adicionar Amigo',
    ratingsModalTitle: 'AvaliaÃ§Ãµes do Item',
    allUsers: 'Todos os Utilizadores',
    friendsOnly: 'Apenas Amigos',
    rateModalTitle: 'Avaliar Item',
    confirm: 'Confirmar',
    share: 'Partilhar',
    delete: 'Eliminar',
    director: 'Realizador',
    cast: 'Elenco',
    recentReviews: 'AvaliaÃ§Ãµes Recentes',
    trailer: 'Trailer',
    addToList: 'Adicionar Ã  Lista',
    friendRatings: 'AvaliaÃ§Ãµes',
    friendLists: 'Listas',
    importList: 'Importar'
  },
  ru: {
    languageQuestionFirst: 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚, Ğ½Ğ° ĞºĞ°ĞºĞ¾Ğ¼ ÑĞ·Ñ‹ĞºĞµ Ğ³Ğ¾Ğ²Ğ¾Ñ€Ğ¸Ğ¼?',
    welcomeTitle: 'Ğ”Ğ¾Ğ±Ñ€Ğ¾ Ğ¿Ğ¾Ğ¶Ğ°Ğ»Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ² CustomLibrary',
    helloQuestion: 'ĞŸÑ€Ğ¸Ğ²ĞµÑ‚, ĞºĞ°Ğº Ñ‚ĞµĞ±Ñ Ğ·Ğ¾Ğ²ÑƒÑ‚?',
    yourName: 'Ğ¢Ğ²Ğ¾Ñ‘ Ğ¸Ğ¼Ñ',
    continue: 'ĞŸÑ€Ğ¾Ğ´Ğ¾Ğ»Ğ¶Ğ¸Ñ‚ÑŒ',
    loginTitle: 'Ğ’Ñ…Ğ¾Ğ´',
    registerTitle: 'Ğ ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ°Ñ†Ğ¸Ñ',
    username: 'Ğ˜Ğ¼Ñ Ğ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ñ',
    password: 'ĞŸĞ°Ñ€Ğ¾Ğ»ÑŒ',
    loginBtn: 'Ğ’Ğ¾Ğ¹Ñ‚Ğ¸',
    registerBtn: 'Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒÑÑ',
    noAccount: 'ĞĞµÑ‚ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚Ğ°?',
    hasAccount: 'Ğ£Ğ¶Ğµ ĞµÑÑ‚ÑŒ Ğ°ĞºĞºĞ°ÑƒĞ½Ñ‚?',
    registerLink: 'Ğ—Ğ°Ñ€ĞµĞ³Ğ¸ÑÑ‚Ñ€Ğ¸Ñ€ÑƒĞ¹ÑÑ',
    loginLink: 'Ğ’Ğ¾Ğ¹Ğ´Ğ¸',
    myLibrary: 'ĞœĞ¾Ñ Ğ‘Ğ¸Ğ±Ğ»Ğ¸Ğ¾Ñ‚ĞµĞºĞ°',
    friends: 'Ğ”Ñ€ÑƒĞ·ÑŒÑ',
    ratings: 'ĞÑ†ĞµĞ½ĞºĞ¸',
    logout: 'Ğ’Ñ‹Ñ…Ğ¾Ğ´',
    myLists: 'ĞœĞ¾Ğ¸ Ğ¡Ğ¿Ğ¸ÑĞºĞ¸',
    createList: 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº',
    addItems: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Items',
    searchPlaceholder: 'Ğ˜ÑĞºĞ°Ñ‚ÑŒ Ñ„Ğ¸Ğ»ÑŒĞ¼Ñ‹/ÑĞµÑ€Ğ¸Ğ°Ğ»Ñ‹',
    madeWith: 'Ğ¡Ğ´ĞµĞ»Ğ°Ğ½Ğ¾ Ñ',
    createListModalTitle: 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ ĞĞ¾Ğ²Ñ‹Ğ¹ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº',
    listName: 'ĞĞ°Ğ·Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞ¿Ğ¸ÑĞºĞ°',
    customMessage: 'ĞŸĞµÑ€ÑĞ¾Ğ½Ğ°Ğ»ÑŒĞ½Ğ¾Ğµ ÑĞ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ (Ğ½ĞµĞ¾Ğ±ÑĞ·Ğ°Ñ‚ĞµĞ»ÑŒĞ½Ğ¾)',
    create: 'Ğ¡Ğ¾Ğ·Ğ´Ğ°Ñ‚ÑŒ',
    cancel: 'ĞÑ‚Ğ¼ĞµĞ½Ğ°',
    selectListModalTitle: 'Ğ’Ñ‹Ğ±Ñ€Ğ°Ñ‚ÑŒ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº',
    shareListModalTitle: 'ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ Ğ¡Ğ¿Ğ¸ÑĞºĞ¾Ğ¼',
    pinLabel: 'PIN:',
    copyPin: 'ĞšĞ¾Ğ¿Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ PIN',
    close: 'Ğ—Ğ°ĞºÑ€Ñ‹Ñ‚ÑŒ',
    importModalTitle: 'Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº',
    enterPin: 'Ğ’Ğ²ĞµĞ´Ğ¸Ñ‚Ğµ PIN',
    import: 'Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ',
    friendsModalTitle: 'Ğ”Ñ€ÑƒĞ·ÑŒÑ',
    myFriendsTab: 'ĞœĞ¾Ğ¸ Ğ”Ñ€ÑƒĞ·ÑŒÑ',
    addFriendTab: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ”Ñ€ÑƒĞ³Ğ°',
    addFriend: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ”Ñ€ÑƒĞ³Ğ°',
    ratingsModalTitle: 'ĞÑ†ĞµĞ½ĞºĞ¸ Item',
    allUsers: 'Ğ’ÑĞµ ĞŸĞ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ñ‚ĞµĞ»Ğ¸',
    friendsOnly: 'Ğ¢Ğ¾Ğ»ÑŒĞºĞ¾ Ğ”Ñ€ÑƒĞ·ÑŒÑ',
    rateModalTitle: 'ĞÑ†ĞµĞ½Ğ¸Ñ‚ÑŒ Item',
    confirm: 'ĞŸĞ¾Ğ´Ñ‚Ğ²ĞµÑ€Ğ´Ğ¸Ñ‚ÑŒ',
    share: 'ĞŸĞ¾Ğ´ĞµĞ»Ğ¸Ñ‚ÑŒÑÑ',
    delete: 'Ğ£Ğ´Ğ°Ğ»Ğ¸Ñ‚ÑŒ',
    director: 'Ğ ĞµĞ¶Ğ¸ÑÑÑ‘Ñ€',
    cast: 'ĞĞºÑ‚Ñ‘Ñ€Ñ‹',
    recentReviews: 'ĞŸĞ¾ÑĞ»ĞµĞ´Ğ½Ğ¸Ğµ ĞÑ‚Ğ·Ñ‹Ğ²Ñ‹',
    trailer: 'Ğ¢Ñ€ĞµĞ¹Ğ»ĞµÑ€',
    addToList: 'Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ¸Ñ‚ÑŒ Ğ² Ğ¡Ğ¿Ğ¸ÑĞ¾Ğº',
    friendRatings: 'ĞÑ†ĞµĞ½ĞºĞ¸',
    friendLists: 'Ğ¡Ğ¿Ğ¸ÑĞºĞ¸',
    importList: 'Ğ˜Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²Ğ°Ñ‚ÑŒ'
  },
  ja: {
    languageQuestionFirst: 'ã“ã‚“ã«ã¡ã¯ã€ä½•èªã‚’è©±ã—ã¾ã™ã‹ï¼Ÿ',
    welcomeTitle: 'CustomLibraryã¸ã‚ˆã†ã“ã',
    helloQuestion: 'ã“ã‚“ã«ã¡ã¯ã€ãŠåå‰ã¯ï¼Ÿ',
    yourName: 'ã‚ãªãŸã®åå‰',
    continue: 'ç¶šã‘ã‚‹',
    loginTitle: 'ãƒ­ã‚°ã‚¤ãƒ³',
    registerTitle: 'ç™»éŒ²',
    username: 'ãƒ¦ãƒ¼ã‚¶ãƒ¼å',
    password: 'ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰',
    loginBtn: 'ãƒ­ã‚°ã‚¤ãƒ³',
    registerBtn: 'ç™»éŒ²',
    noAccount: 'ã‚¢ã‚«ã‚¦ãƒ³ãƒˆãŒã‚ã‚Šã¾ã›ã‚“ã‹ï¼Ÿ',
    hasAccount: 'ã™ã§ã«ã‚¢ã‚«ã‚¦ãƒ³ãƒˆã‚’ãŠæŒã¡ã§ã™ã‹ï¼Ÿ',
    registerLink: 'ç™»éŒ²',
    loginLink: 'ãƒ­ã‚°ã‚¤ãƒ³',
    myLibrary: 'ãƒã‚¤ãƒ©ã‚¤ãƒ–ãƒ©ãƒª',
    friends: 'å‹é”',
    ratings: 'è©•ä¾¡',
    logout: 'ãƒ­ã‚°ã‚¢ã‚¦ãƒˆ',
    myLists: 'ãƒã‚¤ãƒªã‚¹ãƒˆ',
    createList: 'ãƒªã‚¹ãƒˆä½œæˆ',
    addItems: 'ã‚¢ã‚¤ãƒ†ãƒ è¿½åŠ ',
    searchPlaceholder: 'æ˜ ç”»/ã‚·ãƒªãƒ¼ã‚ºã‚’æ¤œç´¢',
    madeWith: 'ä½œæˆè€…',
    createListModalTitle: 'æ–°ã—ã„ãƒªã‚¹ãƒˆã‚’ä½œæˆ',
    listName: 'ãƒªã‚¹ãƒˆå',
    customMessage: 'ã‚«ã‚¹ã‚¿ãƒ ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰',
    create: 'ä½œæˆ',
    cancel: 'ã‚­ãƒ£ãƒ³ã‚»ãƒ«',
    selectListModalTitle: 'ãƒªã‚¹ãƒˆã‚’é¸æŠ',
    shareListModalTitle: 'ãƒªã‚¹ãƒˆã‚’å…±æœ‰',
    pinLabel: 'PIN:',
    copyPin: 'PINã‚’ã‚³ãƒ”ãƒ¼',
    close: 'é–‰ã˜ã‚‹',
    importModalTitle: 'ãƒªã‚¹ãƒˆã‚’ã‚¤ãƒ³ãƒãƒ¼ãƒˆ',
    enterPin: 'PINã‚’å…¥åŠ›',
    import: 'ã‚¤ãƒ³ãƒãƒ¼ãƒˆ',
    friendsModalTitle: 'å‹é”',
    myFriendsTab: 'ãƒã‚¤ãƒ•ãƒ¬ãƒ³ãƒ‰',
    addFriendTab: 'å‹é”ã‚’è¿½åŠ ',
    addFriend: 'å‹é”ã‚’è¿½åŠ ',
    ratingsModalTitle: 'ã‚¢ã‚¤ãƒ†ãƒ ã®è©•ä¾¡',
    allUsers: 'ã™ã¹ã¦ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼',
    friendsOnly: 'å‹é”ã®ã¿',
    rateModalTitle: 'ã‚¢ã‚¤ãƒ†ãƒ ã‚’è©•ä¾¡',
    confirm: 'ç¢ºèª',
    share: 'å…±æœ‰',
    delete: 'å‰Šé™¤',
    director: 'ç›£ç£',
    cast: 'ã‚­ãƒ£ã‚¹ãƒˆ',
    recentReviews: 'æœ€è¿‘ã®ãƒ¬ãƒ“ãƒ¥ãƒ¼',
    trailer: 'äºˆå‘Šç·¨',
    addToList: 'ãƒªã‚¹ãƒˆã«è¿½åŠ ',
    friendRatings: 'è©•ä¾¡',
    friendLists: 'ãƒªã‚¹ãƒˆ',
    importList: 'ã‚¤ãƒ³ãƒãƒ¼ãƒˆ'
  },
  zh: {
    languageQuestionFirst: 'ä½ å¥½ï¼Œæˆ‘ä»¬è¯´ä»€ä¹ˆè¯­è¨€ï¼Ÿ',
    welcomeTitle: 'æ¬¢è¿æ¥åˆ°CustomLibrary',
    helloQuestion: 'ä½ å¥½ï¼Œä½ å«ä»€ä¹ˆåå­—ï¼Ÿ',
    yourName: 'ä½ çš„åå­—',
    continue: 'ç»§ç»­',
    loginTitle: 'ç™»å½•',
    registerTitle: 'æ³¨å†Œ',
    username: 'ç”¨æˆ·å',
    password: 'å¯†ç ',
    loginBtn: 'ç™»å½•',
    registerBtn: 'æ³¨å†Œ',
    noAccount: 'æ²¡æœ‰è´¦æˆ·ï¼Ÿ',
    hasAccount: 'å·²æœ‰è´¦æˆ·ï¼Ÿ',
    registerLink: 'æ³¨å†Œ',
    loginLink: 'ç™»å½•',
    myLibrary: 'æˆ‘çš„å›¾ä¹¦é¦†',
    friends: 'æœ‹å‹',
    ratings: 'è¯„åˆ†',
    logout: 'ç™»å‡º',
    myLists: 'æˆ‘çš„åˆ—è¡¨',
    createList: 'åˆ›å»ºåˆ—è¡¨',
    addItems: 'æ·»åŠ é¡¹ç›®',
    searchPlaceholder: 'æœç´¢ç”µå½±/å‰§é›†',
    madeWith: 'åˆ¶ä½œè€…',
    createListModalTitle: 'åˆ›å»ºæ–°åˆ—è¡¨',
    listName: 'åˆ—è¡¨åç§°',
    customMessage: 'è‡ªå®šä¹‰æ¶ˆæ¯ï¼ˆå¯é€‰ï¼‰',
    create: 'åˆ›å»º',
    cancel: 'å–æ¶ˆ',
    selectListModalTitle: 'é€‰æ‹©åˆ—è¡¨',
    shareListModalTitle: 'åˆ†äº«åˆ—è¡¨',
    pinLabel: 'PIN:',
    copyPin: 'å¤åˆ¶PIN',
    close: 'å…³é—­',
    importModalTitle: 'å¯¼å…¥åˆ—è¡¨',
    enterPin: 'è¾“å…¥PIN',
    import: 'å¯¼å…¥',
    friendsModalTitle: 'æœ‹å‹',
    myFriendsTab: 'æˆ‘çš„æœ‹å‹',
    addFriendTab: 'æ·»åŠ æœ‹å‹',
    addFriend: 'æ·»åŠ æœ‹å‹',
    ratingsModalTitle: 'é¡¹ç›®è¯„åˆ†',
    allUsers: 'æ‰€æœ‰ç”¨æˆ·',
    friendsOnly: 'ä»…æœ‹å‹',
    rateModalTitle: 'è¯„åˆ†é¡¹ç›®',
    confirm: 'ç¡®è®¤',
    share: 'åˆ†äº«',
    delete: 'åˆ é™¤',
    director: 'å¯¼æ¼”',
    cast: 'æ¼”å‘˜',
    recentReviews: 'æœ€è¿‘è¯„è®º',
    trailer: 'é¢„å‘Šç‰‡',
    addToList: 'æ·»åŠ åˆ°åˆ—è¡¨',
    friendRatings: 'è¯„åˆ†',
    friendLists: 'åˆ—è¡¨',
    importList: 'å¯¼å…¥'
  }
};

let currentLanguage = 'en';
let currentUser = null;
let displayName = '';
let allLists = [];
let currentSearchResults = [];
let currentDetailIndex = 0;
let currentRatingFilter = 'all';

const API_URL = window.location.origin;
const TMDB_API_KEY = 'TU_API_KEY_DE_TMDB'; // Reemplaza con tu API key

function t(key) {
  return translations[currentLanguage][key] || key;
}

function applyTranslations() {
  document.getElementById('welcomeTitle').textContent = t('welcomeTitle');
  document.getElementById('languageQuestionLabel').textContent = t('languageQuestionFirst');
  document.getElementById('nameQuestionLabel').textContent = t('helloQuestion');
  document.getElementById('nameInput').placeholder = t('yourName');
  document.getElementById('continueBtn').textContent = t('continue');
  
  document.getElementById('loginTitle').textContent = t('loginTitle');
  document.getElementById('registerTitle').textContent = t('registerTitle');
  document.getElementById('loginUsername').placeholder = t('username');
  document.getElementById('loginPassword').placeholder = t('password');
  document.getElementById('registerUsername').placeholder = t('username');
  document.getElementById('registerPassword').placeholder = t('password');
  document.getElementById('loginBtn').textContent = t('loginBtn');
  document.getElementById('registerBtn').textContent = t('registerBtn');
  document.getElementById('loginSwitch').innerHTML = `${t('noAccount')} <span id="goToRegister">${t('registerLink')}</span>`;
  document.getElementById('registerSwitch').innerHTML = `${t('hasAccount')} <span id="goToLogin">${t('loginLink')}</span>`;
  
  document.getElementById('mainTitle').textContent = t('myLibrary');
  document.getElementById('friendsBtnText').textContent = t('friends');
  document.getElementById('ratingsBtnText').textContent = t('ratings');
  document.getElementById('logoutBtnText').textContent = t('logout');
  document.getElementById('listsTitle').textContent = t('myLists');
  document.getElementById('createListBtnText').textContent = t('createList');
  document.getElementById('searchTitle').textContent = t('addItems');
  document.getElementById('searchInput').placeholder = t('searchPlaceholder');
  document.getElementById('footerMadeWith').textContent = t('madeWith');
  
  document.getElementById('createListModalTitle').textContent = t('createListModalTitle');
  document.getElementById('newListName').placeholder = t('listName');
  document.getElementById('newListMessage').placeholder = t('customMessage');
  document.getElementById('confirmCreateBtn').textContent = t('create');
  document.getElementById('cancelCreateBtn').textContent = t('cancel');
  
  document.getElementById('selectListModalTitle').textContent = t('selectListModalTitle');
  document.getElementById('cancelSelectBtn').textContent = t('cancel');
  
  document.getElementById('shareModalTitle').textContent = t('shareListModalTitle');
  document.getElementById('sharePinLabel').textContent = t('pinLabel');
  document.getElementById('copyPinBtn').textContent = `ğŸ“‹ ${t('copyPin')}`;
  document.getElementById('closePinBtn').textContent = t('close');
  
  document.getElementById('importModalTitle').textContent = t('importModalTitle');
  document.getElementById('importPinInput').placeholder = t('enterPin');
  document.getElementById('confirmImportBtn').textContent = t('import');
  document.getElementById('cancelImportBtn').textContent = t('cancel');
  
  document.getElementById('friendsModalTitle').textContent = t('friendsModalTitle');
  document.getElementById('myFriendsTab').textContent = t('myFriendsTab');
  document.getElementById('addFriendTab').textContent = t('addFriendTab');
  document.getElementById('friendUsernameInput').placeholder = t('username');
  document.getElementById('addFriendBtn').textContent = t('addFriend');
  document.getElementById('closeFriendsBtn').textContent = t('close');
  
  document.getElementById('ratingsModalTitle').textContent = t('ratingsModalTitle');
  document.getElementById('allRatingsBtn').textContent = t('allUsers');
  document.getElementById('friendsRatingsBtn').textContent = t('friendsOnly');
  document.getElementById('closeRatingsBtn').textContent = t('close');
  
  document.getElementById('rateModalTitle').textContent = t('rateModalTitle');
  document.getElementById('confirmRatingBtn').textContent = t('confirm');
  document.getElementById('cancelRatingBtn').textContent = t('cancel');
  
  document.getElementById('detailDirectorLabel').textContent = t('director');
  document.getElementById('detailCastLabel').textContent = t('cast');
  document.getElementById('detailReviewsLabel').textContent = t('recentReviews');
  document.getElementById('detailTrailerText').textContent = t('trailer');
  document.getElementById('detailAddText').textContent = t('addToList');
  
  document.getElementById('friendRatingsLabel').textContent = t('friendRatings');
  document.getElementById('friendListsLabel').textContent = t('friendLists');
  document.getElementById('closeFriendProfileBtn').textContent = t('close');
  
  document.getElementById('goToRegister').onclick = () => switchScreen('registerScreen');
  document.getElementById('goToLogin').onclick = () => switchScreen('loginScreen');
}

// CONTINÃšA EN LA SIGUIENTE PARTE...

// ========== INICIALIZACIÃ“N ==========
document.addEventListener('DOMContentLoaded', () => {
  applyTranslations();
  
  document.getElementById('languageSelect').addEventListener('change', (e) => {
    currentLanguage = e.target.value;
    applyTranslations();
  });
  
  document.getElementById('continueBtn').onclick = showNameInput;
  document.getElementById('nameInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') continueToMain();
  });
  
  document.getElementById('loginBtn').onclick = login;
  document.getElementById('registerBtn').onclick = register;
  
  document.getElementById('logoutBtn').onclick = logout;
  document.getElementById('friendsBtn').onclick = showFriendsModal;
  document.getElementById('ratingsBtn').onclick = showGlobalRatings;
  
  document.getElementById('searchBtn').onclick = searchItems;
  document.getElementById('searchInput').addEventListener('keypress', (e) => {
    if (e.key === 'Enter') searchItems();
  });
  
  document.getElementById('createListBtn').onclick = showCreateListModal;
  
  // Modales
  document.getElementById('cancelCreateBtn').onclick = hideCreateListModal;
  document.getElementById('confirmCreateBtn').onclick = createList;
  document.getElementById('cancelSelectBtn').onclick = hideSelectListModal;
  document.getElementById('closePinBtn').onclick = hideShareModal;
  document.getElementById('cancelImportBtn').onclick = hideImportModal;
  document.getElementById('closeFriendsBtn').onclick = hideFriendsModal;
  document.getElementById('closeRatingsBtn').onclick = hideRatingsModal;
  document.getElementById('cancelRatingBtn').onclick = hideRateModal;
  document.getElementById('confirmRatingBtn').onclick = submitRating;
  
  // Modales backdrop
  document.querySelectorAll('.modal').forEach(modal => {
    modal.addEventListener('click', (e) => {
      if (e.target === modal) modal.classList.remove('active');
    });
  });
  
  showWelcomeScreen();
});

// ========== PANTALLAS ==========
function showWelcomeScreen() {
  switchScreen('welcomeScreen');
}

function showNameInput() {
  document.getElementById('languageSelectDiv').style.display = 'none';
  document.getElementById('nameInputDiv').style.display = 'block';
  document.getElementById('nameInput').focus();
}

async function continueToMain() {
  displayName = document.getElementById('nameInput').value.trim();
  if (!displayName) return;
  
  await registerUser(displayName);
  showLoginScreen();
}

function switchScreen(screenId) {
  document.querySelectorAll('.screen').forEach(screen => screen.classList.remove('active'));
  document.getElementById(screenId).classList.add('active');
}

function showLoginScreen() {
  switchScreen('loginScreen');
  document.getElementById('loginUsername').focus();
}

function showMainScreen() {
  switchScreen('mainScreen');
  updateAddonUrl();
  loadLists();
}

// ========== AUTENTICACIÃ“N ==========
async function registerUser(displayName) {
  try {
    const response = await fetch(`${API_URL}/api/register`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: displayName.toLowerCase().replace(/[^a-z0-9]/g, ''),
        password: 'auto-generated', // No se usa realmente
        displayName
      })
    });
    
    if (!response.ok) {
      currentUser = displayName.toLowerCase().replace(/[^a-z0-9]/g, '');
      await fetchUserData();
    }
  } catch (err) {
    console.error('Register error:', err);
  }
}

async function login() {
  const username = document.getElementById('loginUsername').value.trim();
  const password = document.getElementById('loginPassword').value;
  
  try {
    const response = await fetch(`${API_URL}/api/login`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password })
    });
    
    const data = await response.json();
    if (data.success) {
      currentUser = username;
      displayName = data.displayName || username;
      showMainScreen();
    } else {
      alert('Invalid credentials');
    }
  } catch (err) {
    console.error('Login error:', err);
    alert('Login failed');
  }
}

async function register() {
  const username = document.getElementById('registerUsername').value.trim();
  const password = document.getElementById('registerPassword').value;
  
  if (!username || !password) return alert('Please fill all fields');
  
  try {
    const response = await fetch(`${API_URL}/api/register`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username, password, displayName: username })
    });
    
    const data = await response.json();
    if (data.success) {
      currentUser = username;
      displayName = username;
      showMainScreen();
    } else {
      alert(data.error || 'Registration failed');
    }
  } catch (err) {
    console.error('Register error:', err);
    alert('Registration failed');
  }
}

function logout() {
  currentUser = null;
  displayName = '';
  showWelcomeScreen();
}

async function fetchUserData() {
  try {
    const response = await fetch(`${API_URL}/${currentUser}/manifest.json`);
    const manifest = await response.json();
    document.getElementById('mainTitle').textContent = manifest.name;
  } catch (err) {
    console.error('Fetch user data error:', err);
  }
}

// ========== LISTAS ==========
async function loadLists() {
  try {
    const response = await fetch(`${API_URL}/api/lists/${currentUser}`);
    const data = await response.json();
    allLists = data.lists;
    renderLists();
  } catch (err) {
    console.error('Load lists error:', err);
  }
}

function renderLists() {
  const container = document.getElementById('listsContainer');
  container.innerHTML = '';
  
  allLists.forEach((list, index) => {
    const listEl = document.createElement('div');
    listEl.className = 'list-item';
    listEl.draggable = true;
    listEl.dataset.listId = list.id;
    
    listEl.innerHTML = `
      <div class="list-header">
        <h3>${list.name}</h3>
        <div>
          <button onclick="toggleListContent('${list.id}')">â–¼</button>
          <button onclick="showShareModal('${list.id}')">ğŸ“¤</button>
          <button onclick="deleteList('${list.id}')">ğŸ—‘ï¸</button>
        </div>
      </div>
      <p>${list.message || ''}</p>
      <div class="list-actions">
        <button onclick="showSelectListModal('${list.id}')">â•</button>
        <div class="arrows">
          <button onclick="moveList('${list.id}', -1)">â¬…ï¸</button>
          <button onclick="moveList('${list.id}', 1)">â¡ï¸</button>
        </div>
        <button onclick="deleteList('${list.id}')">ğŸ—‘ï¸</button>
      </div>
      <div class="list-content" id="list-content-${list.id}">
        <div class="list-items" id="list-items-${list.id}"></div>
      </div>
    `;
    
    container.appendChild(listEl);
  });
  
  // Drag and drop
  const listItems = container.querySelectorAll('.list-item');
  listItems.forEach(item => {
    item.addEventListener('dragstart', handleDragStart);
    item.addEventListener('dragover', handleDragOver);
    item.addEventListener('drop', handleDrop);
  });
}

function toggleListContent(listId) {
  const content = document.getElementById(`list-content-${listId}`);
  content.classList.toggle('active');
  loadListItems(listId);
}

async function loadListItems(listId) {
  try {
    const response = await fetch(`${API_URL}/api/lists/${listId}/items`);
    const data = await response.json();
    const container = document.getElementById(`list-items-${listId}`);
    container.innerHTML = '';
    
    data.items.forEach(item => {
      const itemEl = document.createElement('div');
      itemEl.className = 'item-card';
      itemEl.innerHTML = `
        <img src="${item.poster}" alt="${item.title}">
        <div class="item-title">${item.title}</div>
        <button class="remove-btn" onclick="removeItem('${item.id}')">Ã—</button>
        <button class="rate-btn" onclick="showRateModal('${item.tmdb_id}', '${item.title}', '${item.poster}')">â­ ${item.rating || '?'}</button>
      `;
      container.appendChild(itemEl);
    });
  } catch (err) {
    console.error('Load items error:', err);
  }
}

// ========== DRAG & DROP ==========
let draggedItem = null;

function handleDragStart(e) {
  draggedItem = this;
  e.dataTransfer.effectAllowed = 'move';
  setTimeout(() => this.style.display = 'none', 0);
}

function handleDragOver(e) {
  e.preventDefault();
  e.dataTransfer.dropEffect = 'move';
  return false;
}

async function handleDrop(e) {
  e.preventDefault();
  if (draggedItem !== this) {
    const listIds = Array.from(document.querySelectorAll('.list-item')).map(item => item.dataset.listId);
    await fetch(`${API_URL}/api/lists/reorder`, {
      method: 'PUT',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ listIds })
    });
    loadLists();
  }
  draggedItem.style.display = 'block';
  draggedItem = null;
}

// ========== MODALES DE LISTAS ==========
function showCreateListModal() {
  document.getElementById('createListModal').classList.add('active');
  document.getElementById('newListName').focus();
}

function hideCreateListModal() {
  document.getElementById('createListModal').classList.remove('active');
}

async function createList() {
  const name = document.getElementById('newListName').value.trim();
  const message = document.getElementById('newListMessage').value;
  
  if (!name) return;
  
  try {
    const response = await fetch(`${API_URL}/api/lists`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username: currentUser, name, message })
    });
    
    const data = await response.json();
    if (data.success) {
      hideCreateListModal();
      loadLists();
    }
  } catch (err) {
    console.error('Create list error:', err);
  }
}

function showSelectListModal(listId) {
  const modal = document.getElementById('selectListModal');
  const options = document.getElementById('selectListOptions');
  options.innerHTML = '';
  
  allLists.filter(list => list.id !== listId).forEach(list => {
    const btn = document.createElement('button');
    btn.textContent = list.name;
    btn.onclick = () => addItemToList(listId, list.id);
    options.appendChild(btn);
  });
  
  modal.classList.add('active');
}

function hideSelectListModal() {
  document.getElementById('selectListModal').classList.remove('active');
}

function showShareModal(listId) {
  const list = allLists.find(l => l.id === listId);
  document.getElementById('sharePinInput').value = list.pin;
  document.getElementById('shareModal').classList.add('active');
}

function hideShareModal() {
  document.getElementById('shareModal').classList.remove('active');
}

async function deleteList(listId) {
  if (!confirm('Delete this list?')) return;
  
  try {
    await fetch(`${API_URL}/api/lists/${listId}`, { method: 'DELETE' });
    loadLists();
  } catch (err) {
    console.error('Delete list error:', err);
  }
}

async function moveList(listId, direction) {
  const lists = [...allLists];
  const currentIndex = lists.findIndex(l => l.id === listId);
  const newIndex = currentIndex + direction;
  
  if (newIndex < 0 || newIndex >= lists.length) return;
  
  [lists[currentIndex], lists[newIndex]] = [lists[newIndex], lists[currentIndex]];
  allLists = lists;
  
  const listIds = lists.map(l => l.id);
  await fetch(`${API_URL}/api/lists/reorder`, {
    method: 'PUT',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({ listIds })
  });
  
  renderLists();
}

async function removeItem(itemId) {
  if (!confirm('Remove this item?')) return;
  
  try {
    await fetch(`${API_URL}/api/lists/${listId}/items/${itemId}`, { method: 'DELETE' });
    loadListItems(currentListId); // Necesitas currentListId en contexto
  } catch (err) {
    console.error('Remove item error:', err);
  }
}

// CONTINÃšA EN LA SIGUIENTE PARTE...
// ========== BÃšSQUEDA FULLSCREEN ==========
async function searchItems() {
  const query = document.getElementById('searchInput').value.trim();
  if (!query) return;
  
  try {
    // BÃºsqueda TMDB
    const response = await fetch(
      `https://api.themoviedb.org/3/search/multi?api_key=${TMDB_API_KEY}&query=${encodeURIComponent(query)}&language=${currentLanguage}&page=1`
    );
    
    const data = await response.json();
    currentSearchResults = data.results.slice(0, 20); // Limitar a 20 resultados
    currentDetailIndex = 0;
    
    if (currentSearchResults.length > 0) {
      showItemDetailModal(0);
    }
  } catch (err) {
    console.error('Search error:', err);
    alert('Search failed');
  }
}

function showItemDetailModal(index) {
  if (index < 0 || index >= currentSearchResults.length) return;
  
  currentDetailIndex = index;
  const item = currentSearchResults[index];
  const detailModal = document.getElementById('itemDetailModal');
  
  document.getElementById('detailTitle').textContent = item.title || item.name || 'Unknown';
  document.getElementById('detailPoster').src = `https://image.tmdb.org/t/p/w500${item.poster_path}`;
  document.getElementById('detailPoster').alt = item.title || item.name;
  document.getElementById('detailBackdrop').style.backgroundImage = `url(https://image.tmdb.org/t/p/original${item.backdrop_path || item.poster_path})`;
  
  // Meta info
  document.getElementById('detailRating').textContent = `â­ ${item.vote_average ? (item.vote_average / 2).toFixed(1) : '--'}`;
  document.getElementById('detailYear').textContent = item.release_date?.substring(0, 4) || item.first_air_date?.substring(0, 4) || '----';
  document.getElementById('detailRuntime').textContent = item.runtime ? `${item.runtime} min` : '-- min';
  document.getElementById('detailOverview').textContent = item.overview || 'No description available';
  
  // Director y cast (simplificado)
  document.getElementById('detailDirector').textContent = 'Various';
  document.getElementById('detailCast').textContent = 'Multiple actors';
  
  // Reviews simuladas (en producciÃ³n conectar a BD)
  renderReviews();
  
  detailModal.classList.add('active');
}

function renderReviews() {
  const reviewsContainer = document.getElementById('detailReviews');
  const sampleReviews = [
    { user: 'john_doe', rating: 8, text: 'Great movie! Highly recommended.', time: '2h ago' },
    { user: 'mary_smith', rating: 7, text: 'Good but predictable plot.', time: '5h ago' },
    { user: 'fan123', rating: 9, text: 'Masterpiece! Best of the year.', time: '1d ago' }
  ];
  
  reviewsContainer.innerHTML = sampleReviews.map(review => `
    <div class="review-item">
      <div class="review-header">
        <span>${review.user}</span>
        <span>â­ ${review.rating}/10 ${review.time}</span>
      </div>
      <div class="review-text">${review.text}</div>
    </div>
  `).join('');
}

document.getElementById('closeDetailBtn').onclick = () => {
  document.getElementById('itemDetailModal').classList.remove('active');
};

document.getElementById('prevItemBtn').onclick = () => showItemDetailModal(currentDetailIndex - 1);
document.getElementById('nextItemBtn').onclick = () => showItemDetailModal(currentDetailIndex + 1);

document.getElementById('detailTrailerBtn').onclick = async () => {
  const item = currentSearchResults[currentDetailIndex];
  const tmdbId = item.id;
  const mediaType = item.media_type || (item.title ? 'movie' : 'tv');
  
  try {
    const response = await fetch(
      `https://api.themoviedb.org/3/${mediaType}/${tmdbId}/videos?api_key=${TMDB_API_KEY}&language=${currentLanguage}`
    );
    const data = await response.json();
    const trailer = data.results.find(v => v.type === 'Trailer' && v.site === 'YouTube');
    
    if (trailer) {
      window.open(`https://www.youtube.com/watch?v=${trailer.key}`, '_blank');
    } else {
      alert('No trailer found');
    }
  } catch (err) {
    console.error('Trailer error:', err);
    alert('Trailer search failed');
  }
};

document.getElementById('detailAddBtn').onclick = () => {
  const item = currentSearchResults[currentDetailIndex];
  showSelectListModalForItem(item);
};

// ========== SISTEMA DE RATINGS 1-10 ESTRELLAS ==========
function showRateModal(tmdbId, title, poster) {
  document.getElementById('rateItemName').textContent = title;
  document.querySelector('.star-rating').dataset.tmdbId = tmdbId;
  document.querySelector('.star-rating').dataset.title = title;
  document.querySelector('.star-rating').dataset.poster = poster;
  document.getElementById('rateModal').classList.add('active');
  
  // Reset stars
  document.querySelectorAll('.star').forEach(star => {
    star.classList.remove('active');
  });
}

document.querySelectorAll('.star').forEach(star => {
  star.onclick = (e) => {
    const value = parseInt(e.target.dataset.value);
    document.getElementById('ratingValue').textContent = `${value}/10`;
    
    document.querySelectorAll('.star').forEach((s, index) => {
      if (index < value) {
        s.classList.add('active');
      } else {
        s.classList.remove('active');
      }
    });
  };
});

async function submitRating() {
  const stars = document.querySelectorAll('.star.active');
  const rating = stars.length;
  const starContainer = document.querySelector('.star-rating');
  const tmdbId = starContainer.dataset.tmdbId;
  const title = starContainer.dataset.title;
  const poster = starContainer.dataset.poster;
  
  if (!rating) return;
  
  try {
    await fetch(`${API_URL}/api/ratings`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: currentUser,
        tmdbId,
        mediaType: 'movie', // Simplificado
        title,
        poster,
        rating
      })
    });
    
    hideRateModal();
    alert('Rating saved!');
  } catch (err) {
    console.error('Submit rating error:', err);
    alert('Rating failed');
  }
}

function hideRateModal() {
  document.getElementById('rateModal').classList.remove('active');
}

// ========== AMIGOS ==========
async function showFriendsModal() {
  await loadFriends();
  document.getElementById('friendsModal').classList.add('active');
}

async function loadFriends() {
  try {
    const response = await fetch(`${API_URL}/api/friends/${currentUser}`);
    const data = await response.json();
    
    const friendsList = document.getElementById('friendsList');
    friendsList.innerHTML = '';
    
    data.friends.forEach(friend => {
      const friendEl = document.createElement('div');
      friendEl.className = 'friend-item';
      friendEl.onclick = () => showFriendProfile(friend);
      friendEl.innerHTML = `
        <span>${friend}</span>
        <span>ğŸ‘¤</span>
      `;
      friendsList.appendChild(friendEl);
    });
  } catch (err) {
    console.error('Load friends error:', err);
  }
}

document.getElementById('addFriendBtn').onclick = async () => {
  const friendUsername = document.getElementById('friendUsernameInput').value.trim();
  if (!friendUsername) return;
  
  try {
    await fetch(`${API_URL}/api/friends`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username: currentUser, friendUsername })
    });
    
    document.getElementById('friendUsernameInput').value = '';
    loadFriends();
  } catch (err) {
    console.error('Add friend error:', err);
    alert('Friend already added or not found');
  }
};

async function showFriendProfile(username) {
  document.getElementById('friendProfileName').textContent = username;
  
  // Load ratings
  try {
    const ratingsResponse = await fetch(`${API_URL}/api/ratings/user/${username}`);
    const ratingsData = await ratingsResponse.json();
    
    const ratingsContainer = document.getElementById('friendRatingsList');
    ratingsContainer.innerHTML = '';
    
    ratingsData.ratings.slice(0, 10).forEach(rating => {
      const ratingEl = document.createElement('div');
      ratingEl.className = 'rating-item';
      ratingEl.innerHTML = `
        <div>
          <strong>${rating.title}</strong><br>
          <span>â­ ${rating.rating}/10</span>
        </div>
      `;
      ratingsContainer.appendChild(ratingEl);
    });
  } catch (err) {
    console.error('Load friend ratings error:', err);
  }
  
  // Load lists
  try {
    const listsResponse = await fetch(`${API_URL}/api/friends/${username}/lists`);
    const listsData = await listsResponse.json();
    
    const listsContainer = document.getElementById('friendListsContainer');
    listsContainer.innerHTML = '';
    
    listsData.lists.forEach(list => {
      const listEl = document.createElement('div');
      listEl.className = 'friend-list-item';
      listEl.innerHTML = `
        <span>${list.name}</span>
        <button onclick="importFriendList('${username}', '${list.id}')">${t('importList')}</button>
      `;
      listsContainer.appendChild(listEl);
    });
  } catch (err) {
    console.error('Load friend lists error:', err);
  }
  
  document.getElementById('friendProfileModal').classList.add('active');
}

function hideFriendsModal() {
  document.getElementById('friendsModal').classList.remove('active');
}

// ========== IMPORTAR LISTA DE AMIGO ==========
async function importFriendList(friendUsername, listId) {
  if (!confirm('Import this list?')) return;
  
  try {
    const response = await fetch(`${API_URL}/api/lists/import`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ username: currentUser, pin: 'friend' }) // En producciÃ³n usar PIN real
    });
    
    const data = await response.json();
    if (data.success) {
      loadLists();
      alert('List imported!');
    }
  } catch (err) {
    console.error('Import friend list error:', err);
    alert('Import failed');
  }
}

// ========== URL DEL ADDON ==========
function updateAddonUrl() {
  const addonUrl = `${API_URL}/${currentUser}`;
  document.getElementById('addonUrl').textContent = addonUrl;
  document.getElementById('addonUrl').title = 'Copy to install in Stremio';
  
  document.getElementById('addonUrl').onclick = () => {
    navigator.clipboard.writeText(addonUrl);
    alert('Addon URL copied!');
  };
}

// ========== FUNCIONES AUXILIARES ==========
async function addItemToList(listId, targetListId) {
  const item = currentSearchResults[currentDetailIndex];
  
  try {
    await fetch(`${API_URL}/api/lists/${targetListId}/items`, {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        username: currentUser,
        item: {
          tmdbId: item.id,
          imdbId: item.imdb_id || '',
          mediaType: item.media_type || (item.title ? 'movie' : 'tv'),
          title: item.title || item.name,
          poster: `https://image.tmdb.org/t/p/w500${item.poster_path}`,
          overview: item.overview,
          rating: item.vote_average,
          releaseDate: item.release_date || item.first_air_date,
          runtime: item.runtime,
          genres: item.genre_ids?.join(', '),
          director: '',
          cast: ''
        }
      })
    });
    
    hideSelectListModal();
    document.getElementById('itemDetailModal').classList.remove('active');
    loadListItems(targetListId);
    alert('Item added!');
  } catch (err) {
    console.error('Add item error:', err);
    alert('Failed to add item');
  }
}

function hideFriendProfile() {
  document.getElementById('friendProfileModal').classList.remove('active');
}

// Event listeners para tabs de amigos
document.querySelectorAll('.tab-btn').forEach(btn => {
  btn.onclick = () => {
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
    
    btn.classList.add('active');
    document.getElementById(btn.dataset.tab + 'Content').classList.add('active');
  };
});

// Filter ratings
document.getElementById('allRatingsBtn').onclick = () => filterRatings('all');
document.getElementById('friendsRatingsBtn').onclick = () => filterRatings('friends');

async function showGlobalRatings() {
  currentRatingFilter = 'all';
  await loadRatings();
  document.getElementById('ratingsModal').classList.add('active');
}

async function loadRatings() {
  // En producciÃ³n cargar ratings populares o recientes
  const ratingsList = document.getElementById('ratingsList');
  ratingsList.innerHTML = `
    <div class="rating-item">
      <strong>Inception</strong><br>
      <span>Average: â­ 8.7/10 (124 ratings)</span>
      <button onclick="showRatingsForItem('tt1375666')">View ratings</button>
    </div>
  `;
}

function filterRatings(filter) {
  currentRatingFilter = filter;
  document.querySelectorAll('.filter-btn').forEach(btn => btn.classList.remove('active'));
  event.target.classList.add('active');
  // Reload ratings with filter
  loadRatings();
}

function showRatingsForItem(imdbId) {
  // Mostrar ratings especÃ­ficos del item
}

// AÃ±adir event listeners faltantes
document.getElementById('closeFriendProfileBtn').onclick = hideFriendProfile;
document.getElementById('closeDetailBtn').onclick = () => document.getElementById('itemDetailModal').classList.remove('active');

console.log('âœ… CustomLibrary Frontend loaded');
